# -*- coding: utf-8 -*-

"""
/***************************************************************************
 SciPyFilters
                                 A QGIS plugin
 Filter collection implemented with SciPy
 Generated by Plugin Builder: http://g-sherman.github.io/Qgis-Plugin-Builder/
                              -------------------
        begin                : 2024-03-03
        copyright            : (C) 2024 by Florian Neukirchen
        email                : mail@riannek.de
 ***************************************************************************/

/***************************************************************************
 *                                                                         *
 *   This program is free software; you can redistribute it and/or modify  *
 *   it under the terms of the GNU General Public License as published by  *
 *   the Free Software Foundation; either version 2 of the License, or     *
 *   (at your option) any later version.                                   *
 *                                                                         *
 ***************************************************************************/
"""

__author__ = 'Florian Neukirchen'
__date__ = '2024-03-03'
__copyright__ = '(C) 2024 by Florian Neukirchen'

# This will get replaced with a git SHA1 when you do a git archive

__revision__ = '$Format:%H$'

import numpy as np
from osgeo import gdal
from scipy import ndimage, signal
from qgis.PyQt.QtCore import QCoreApplication
from qgis.core import (QgsProcessing,
                       QgsProcessingAlgorithm,
                       QgsProcessingParameterRasterLayer,
                       QgsProcessingParameterNumber,
                       QgsProcessingParameterRasterDestination,
                       QgsProcessingParameterEnum,
                       QgsProcessingParameterBand,)
                        
from .scipy_algorithm_baseclasses import (SciPyAlgorithm,
                                          SciPyAlgorithmWithMode,
                                          SciPyAlgorithmWithModeAxis,
                                          SciPyStatisticalAlgorithm,
                                          QgsProcessingParameterString)

from .scipy_gaussian_algorithm import SciPyAlgorithmWithSigma

from .ui.sizes_widget import (OddSizesWidgetWrapper)


from .helpers import str_to_int_or_list

class SciPyPixelMinAlgorithm(SciPyAlgorithm):
    """
    Pixel Statistics Minimum

    """


    # Overwrite constants of base class
    _name = 'pixel_minimum'
    _displayname = 'Pixel minimum filter'
    _outputname = None
    _groupid = "pixel" 
    _outbands = 1
    _help = """
            Pixel minimum filter

            Returns minimum of all bands
            """
    
    # The function to be called, to be overwritten
    def get_fct(self):
        return self.myfnct
    
    def myfnct(self, a, **kwargs):
        kwargs["axis"] = 0
        dtype = kwargs.pop("output")
        return np.min(a, **kwargs).astype(dtype)
    

    def initAlgorithm(self, config):
        # Set dimensions to 3
        self._dimension = self.Dimensions.threeD
        super().initAlgorithm(config)
        

    def createInstance(self):
        return SciPyPixelMinAlgorithm()
    

